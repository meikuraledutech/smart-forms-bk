FORMS MODULE â€“ README

This module implements form creation and management
using Go (Fiber), PostgreSQL, and raw SQL.

FEATURES
- Create forms
- List forms (pagination + search)
- Get form by ID
- Update form (PATCH)
- Soft delete forms
- User-scoped access (JWT)
- Flow integration (dynamic question trees)
- Raw SQL only
- No ORM
- UTC-based timestamps

FORM MODEL
- id (uuid)
- user_id (owner)
- title
- description
- status (draft | published)
- auto_slug (unique, generated on publish)
- custom_slug (unique, optional custom URL)
- accepting_responses (boolean, controls submissions)
- published_at (timestamp, when published)
- created_at (UTC)
- updated_at (UTC)
- deleted_at (soft delete)

FORM ENDPOINTS

1. Create Form
POST /forms
Headers:
Authorization: Bearer <access_token>

Body:
{
  "title": "Student Feedback",
  "description": "Feedback form"
}

Response:
- 201: form created

Example:
TOKEN="your_access_token"
curl -X POST http://localhost:3030/forms \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "title": "Student Feedback",
    "description": "Feedback form"
  }'

2. List Forms
GET /forms
Headers:
Authorization: Bearer <access_token>

Query Params:
- limit (default 10)
- offset (default 0)
- search (optional, title)

Response:
{
  "items": [...],
  "total": 10,
  "limit": 10,
  "offset": 0
}

Example:
TOKEN="your_access_token"
curl -X GET "http://localhost:3030/forms?limit=10&offset=0&search=feedback" \
  -H "Authorization: Bearer $TOKEN"

3. Get Form by ID
GET /forms/:id
Headers:
Authorization: Bearer <access_token>

Response:
- 200: form data
- 404: not found

Example:
TOKEN="your_access_token"
FORM_ID="form-uuid-here"
curl -X GET "http://localhost:3030/forms/$FORM_ID" \
  -H "Authorization: Bearer $TOKEN"

4. Update Form
PATCH /forms/:id
Headers:
Authorization: Bearer <access_token>

Body:
{
  "title": "Updated title",
  "description": "Updated description",
  "status": "published"
}

Response:
- 204: updated

Example:
TOKEN="your_access_token"
FORM_ID="form-uuid-here"
curl -X PATCH "http://localhost:3030/forms/$FORM_ID" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "title": "Updated title",
    "description": "Updated description",
    "status": "published"
  }'

5. Soft Delete Form
PATCH /forms/:id/delete
Headers:
Authorization: Bearer <access_token>

Response:
- 204: deleted

Example:
TOKEN="your_access_token"
FORM_ID="form-uuid-here"
curl -X PATCH "http://localhost:3030/forms/$FORM_ID/delete" \
  -H "Authorization: Bearer $TOKEN"

FLOW INTEGRATION
Forms connect to dynamic question flows.

Flow Endpoints:
- PATCH /forms/:form_id/flow - Create/update flow
- GET /forms/:form_id/flow - Get flow structure

See flows.txt for complete flow documentation.

RULES
- Forms are user-owned
- Deleted forms are excluded from all queries
- Only PATCH, POST, GET (no PUT/DELETE)
- List ordered by updated_at DESC
- Each form can have one flow (1:1 relationship)

MIGRATIONS
- Raw SQL only
- Files:
  migrations/002_create_forms.up.sql
  migrations/002_create_forms.down.sql
  migrations/005_add_publish_fields_to_forms.up.sql
  migrations/005_add_publish_fields_to_forms.down.sql

IMPLEMENTED INTEGRATIONS
- Flow module (dynamic question trees)
- Questions module (auto-created from flows)
- Links module (form publishing, public URLs)

PUBLISH INTEGRATION
- Forms can be published to generate public URLs
- See docs/links.txt for publishing details
- auto_slug generated automatically (11 chars)
- custom_slug optional (user-defined, 3-50 chars)
- accepting_responses controls if form accepts submissions
- Both slugs work: /f/auto_slug or /f/custom_slug

FUTURE EXTENSIONS (NOT IMPLEMENTED)
- Form responses/submissions
- Role-based access
- Analytics dashboard
- Form templates
- Duplicate forms
- Form versioning

STATUS
Forms core is complete and working.
Flow integration is complete and tested.
Links/publishing module is complete and tested.
Ready for responses/submissions module.
